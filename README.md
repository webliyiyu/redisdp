<!--
 * @Author: Guojian Wang 1085844536@qq.com
 * @Date: 2023-04-13 13:56:39
 * @LastEditTime: 2023-04-20 15:39:05
 * @LastEditors: Guojian Wang 1085844536@qq.com
 * @FilePath: \READMEd:\Developer\WGJ\Java_WorkSpace\redis\README.md
 * @Description:
-->
# Redis入门到实战教程

***

<h2>
    深度透析redis底层原理+redis分布式锁+企业解决方案+点评实战项目
</h2>

***

## 目录

- [Redis入门到实战教程](#redis入门到实战教程)
  - [目录](#目录)
  - [Redis - Redis 概念和应用场景](#redis---redis-概念和应用场景)
    - [什么是 Redis](#什么是-redis)
    - [为什么要使用 Redis](#为什么要使用-redis)
    - [Redis 的使用场景](#redis-的使用场景)
      - [热点数据的缓存](#热点数据的缓存)
      - [限时业务的运用](#限时业务的运用)
      - [计数器相关问题](#计数器相关问题)
      - [分布式锁](#分布式锁)
      - [延时操作](#延时操作)
      - [排行榜相关问题](#排行榜相关问题)
      - [点赞、好友等相互关系的存储](#点赞好友等相互关系的存储)
      - [简单队列](#简单队列)
    - [官方文档](#官方文档)
  - [00-课程介绍](#00-课程介绍)
  - [01-入门篇](#01-入门篇)
  - [02-实战篇](#02-实战篇)
  - [03-高级篇](#03-高级篇)
    - [01-分布式缓存](#01-分布式缓存)
    - [02-多级缓存](#02-多级缓存)
    - [03-最佳实践](#03-最佳实践)

***

## Redis - Redis 概念和应用场景

> Redis 是一种支持 key-value 等多种数据结构的存储系统。可用于缓存，事件发布或订阅，高速队列等场景。支持网络，提供字符串，哈希，列表，队列，集合结构直接存取，基于内存，可持久化。

<div align="center">
    <img src="./doc/Redis.png" alt=Redis.png>
</div>

***

### 什么是 Redis

Redis 是一款内存高速缓存数据库。Redis 全称为：Remote Dictionary Server（远程词典服务），使用 C 语言编写，Redis 是一个 key-value 存储系统（键值存储系统），是一个基于内存的键值型 NoSQL 数据库，支持丰富的数据类型，如：String、list、set、zset、hash。

***

### 为什么要使用 Redis

- 读写性能优异
  - Redis 能读的速度是 110000 次 /s, 写的速度是 81000 次 /s （测试条件见下一节）。
- 数据类型丰富
  - Redis 支持二进制案例的 Strings, Lists, Hashes, Sets 及 Ordered Sets 数据类型操作。
- 原子性
  - Redis 的所有操作都是原子性的，同时 Redis 还支持对几个操作全并后的原子性执行。
- 丰富的特性
  - Redis 支持 publish/subscribe, 通知，key 过期等特性。
- 持久化
  - Redis 支持 RDB, AOF 等持久化方式
- 发布订阅
  - Redis 支持发布 / 订阅模式
- 分布式
  - Redis Cluster

> 下面是官方的 bench-mark 根据如下条件获得的性能测试（读的速度是 110000 次 /s, 写的速度是 81000 次 /s）

- 测试完成了 50 个并发执行 100000 个请求。
- 设置和获取的值是一个 256 字节字符串。
- Linux box 是运行 Linux 2.6, 这是 X3320 Xeon 2.5 ghz。
- 文本执行使用 loopback 接口 (127.0.0.1)。

***

### Redis 的使用场景

#### 热点数据的缓存

缓存是 Redis 最常见的应用场景，之所有这么使用，主要是因为 Redis 读写性能优异。而且逐渐有取代 memcached，成为首选服务端缓存的组件。而且，Redis 内部是支持事务的，在使用时候能有效保证数据的一致性。

作为缓存使用时，一般有两种方式保存数据：

- 读取前，先去读 Redis，如果没有数据，读取数据库，将数据拉入 Redis。
- 插入数据时，同时写入 Redis。

方案一：实施起来简单，但是有两个需要注意的地方：

- 避免缓存击穿。（数据库没有就需要命中的数据，导致 Redis 一直没有数据，而一直命中数据库。）
- 数据的实时性相对会差一点。

方案二：数据实时性强，但是开发时不便于统一处理。

当然，两种方式根据实际情况来适用。如：方案一适用于对于数据实时性要求不是特别高的场景。方案二适用于字典表、数据量不大的数据存储。

#### 限时业务的运用

redis 中可以使用 expire 命令设置一个键的生存时间，到时间后 redis 会删除它。利用这一特性可以运用在限时的优惠活动信息、手机验证码等业务场景。

#### 计数器相关问题

redis 由于 incrby 命令可以实现 `原子性` 的递增，所以可以运用于高并发的秒杀活动、分布式序列号的生成、具体业务还体现在比如限制一个手机号发多少条短信、一个接口一分钟限制多少请求、一个接口一天限制调用多少次等等。

#### 分布式锁

这个主要利用 redis 的 setnx 命令进行，setnx：”set if not exists” 就是如果不存在则成功设置缓存同时返回 1，否则返回 0 ，这个特性在很多后台中都有所运用，因为我们服务器是集群的，定时任务可能在两台机器上都会运行，所以在定时任务中首先 通过 setnx 设置一个 lock， 如果成功设置则执行，如果没有成功设置，则表明该定时任务已执行。 当然结合具体业务，我们可以给这个 lock 加一个过期时间，比如说 30 分钟执行一次的定时任务，那么这个过期时间设置为小于 30 分钟的一个时间就可以，这个与定时任务的周期以及定时任务执行消耗时间相关。

在分布式锁的场景中，主要用在比如秒杀系统等。

#### 延时操作

比如在订单生产后我们占用了库存，10 分钟后去检验用户是否真正购买，如果没有购买将该单据设置无效，同时还原库存。 由于 redis 自 2.8.0 之后版本提供 Keyspace Notifications 功能，允许客户订阅 Pub/Sub 频道，以便以某种方式接收影响 Redis 数据集的事件。 所以我们对于上面的需求就可以用以下解决方案，我们在订单生产时，设置一个 key，同时设置 10 分钟后过期， 我们在后台实现一个监听器，监听 key 的失效，监听到 key 失效时将后续逻辑加上。

当然我们也可以利用 rabbitmq、activemq 等消息中间件的延迟队列服务实现该需求。

#### 排行榜相关问题

关系型数据库在排行榜方面查询速度普遍偏慢，所以可以借助 redis 的 SortedSet 进行热点数据的排序。

比如点赞排行榜，做一个 SortedSet , 然后以用户的 openid 作为上面的 username , 以用户的点赞数作为上面的 score , 然后针对每个用户做一个 hash, 通过 zrangebyscore 就可以按照点赞数获取排行榜，然后再根据 username 获取用户的 hash 信息，这个当时在实际运用中性能体验也蛮不错的。

#### 点赞、好友等相互关系的存储

Redis 利用集合的一些命令，比如求交集、并集、差集等。

在微博应用中，每个用户关注的人存在一个集合中，就很容易实现求两个人的共同好友功能。

#### 简单队列

由于 Redis 有 list push 和 list pop 这样的命令，所以能够很方便的执行队列操作。

***

### 官方文档

Redis 官网:<http://redis.io/>

Redis 官方文档:<http://redis.io/documentation>

Redis 下载:<http://redis.io/download>

***

## [00-课程介绍](./doc/00.课程介绍.md)

***

## [01-入门篇](./doc/01-入门篇/01.入门篇.md)

***

## [02-实战篇](./doc/02-实战篇/02.实战篇.md)

***

## 03-高级篇

### [01-分布式缓存](./doc/03-高级篇/01-分布式缓存/Redis高级-分布式缓存.md)

### [02-多级缓存](./doc/03-高级篇/02-多级缓存/Redis高级-多级缓存.md)

### [03-最佳实践](./doc/03-高级篇/03-最佳实践/Redis高级-最佳实践.md)

***

## [04-原理篇](./doc/04-原理篇/04.原理篇.md)

***

